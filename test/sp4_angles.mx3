/*
	Test angle output.
*/

// geometry
	setgridsize(128, 32, 1)
	setcellsize(500e-9/128, 125e-9/32, 3e-9)

// material
	Msat  = 800e3
	TOL := 1e-5
	m  = uniform(1, 0, 0)
	expectv("ext_rxyphitheta", ext_rxyphitheta.average(), vector(1, 0, pi/2.0), TOL)
	m  = uniform(0, 1, 0)
	expectv("ext_rxyphitheta", ext_rxyphitheta.average(), vector(1, pi/2.0, pi/2.0), TOL)
	m  = uniform(1, 1, 0)
	expectv("ext_rxyphitheta", ext_rxyphitheta.average(), vector(1, pi/4.0, pi/2.0), TOL)
	m = uniform(1, 0, 1)
	expectv("ext_rxyphitheta", ext_rxyphitheta.average(), vector(1/sqrt(2), 0, pi/4.0), TOL)